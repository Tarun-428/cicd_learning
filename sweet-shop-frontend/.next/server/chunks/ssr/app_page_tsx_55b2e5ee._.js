module.exports=[60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e(){let[a,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)("login"),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)({text:"",type:""}),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(null);(0,d.useRouter)();let[B,C]=(0,c.useState)({username:"",email:"",password:"",sweetName:"",sweetCategory:"",sweetPrice:"",sweetQuantity:""}),D=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000";(0,c.useEffect)(()=>{let a=localStorage.getItem("access_token"),b=localStorage.getItem("user");a&&b&&(e(!0),i(JSON.parse(b)),g("dashboard"),G())},[]),(0,c.useEffect)(()=>{E()},[n,p,r,t,j]);let E=()=>{let a=[...j];n&&(a=a.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.category.toLowerCase().includes(n.toLowerCase()))),p&&(a=a.filter(a=>a.category.toLowerCase()===p.toLowerCase())),r&&(a=a.filter(a=>a.price>=Number.parseFloat(r))),t&&(a=a.filter(a=>a.price<=Number.parseFloat(t))),m(a)},F=(a,b)=>{w({text:a,type:b}),setTimeout(()=>w({text:"",type:""}),4e3)},G=async()=>{let a=localStorage.getItem("access_token");try{let b=await fetch(`${D}/api/sweets/`,{headers:{Authorization:`Bearer ${a}`}});if(401===b.status)return void J();if(b.ok){let a=await b.json();k(a)}}catch(a){F("Failed to fetch sweets","error")}},H=async a=>{a.preventDefault();try{let a=await fetch(`${D}/api/auth/login/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:B.username,password:B.password})}),b=await a.json();if(a.ok){localStorage.setItem("access_token",b.access_token);let a={username:B.username,is_staff:b.is_staff||!1};localStorage.setItem("user",JSON.stringify(a)),i(a),e(!0),g("dashboard"),F("Login successful!","success"),G()}else F(b.message||"Login failed","error")}catch(a){F("Login failed. Please try again.","error")}},I=async a=>{a.preventDefault();try{let a=await fetch(`${D}/api/auth/register/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:B.username,email:B.email,password:B.password})}),b=await a.json();a.ok?(F("Registration successful! Please login.","success"),g("login"),C({...B,password:""})):F(b.message||"Registration failed","error")}catch(a){F("Registration failed. Please try again.","error")}},J=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("user"),e(!1),i(null),g("login"),k([]),F("Logged out successfully","success")},K=async a=>{let b=localStorage.getItem("access_token");try{let c=await fetch(`${D}/api/sweets/${a}/purchase/`,{method:"POST",headers:{Authorization:`Bearer ${b}`}});if(401===c.status)return void J();if(c.ok)F("Purchase successful!","success"),G();else{let a=await c.json();F(a.message||"Purchase failed","error")}}catch(a){F("Purchase failed. Please try again.","error")}},L=async a=>{a.preventDefault();let b=localStorage.getItem("access_token");try{let a=await fetch(`${D}/api/sweets/`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({name:B.sweetName,category:B.sweetCategory,price:Number.parseFloat(B.sweetPrice),quantity:Number.parseInt(B.sweetQuantity)})});if(403===a.status)return void F("Access Denied: Admin only","error");a.ok?(F("Sweet added successfully!","success"),y(null),C({...B,sweetName:"",sweetCategory:"",sweetPrice:"",sweetQuantity:""}),G()):F("Failed to add sweet","error")}catch(a){F("Failed to add sweet","error")}},M=async a=>{if(a.preventDefault(),!z)return;let b=localStorage.getItem("access_token");try{let a=await fetch(`${D}/api/sweets/${z.id}/`,{method:"PUT",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({name:B.sweetName,category:B.sweetCategory,price:Number.parseFloat(B.sweetPrice),quantity:Number.parseInt(B.sweetQuantity)})});if(403===a.status)return void F("Access Denied: Admin only","error");a.ok?(F("Sweet updated successfully!","success"),y(null),A(null),C({...B,sweetName:"",sweetCategory:"",sweetPrice:"",sweetQuantity:""}),G()):F("Failed to update sweet","error")}catch(a){F("Failed to update sweet","error")}},N=async a=>{if(!confirm("Are you sure you want to delete this sweet?"))return;let b=localStorage.getItem("access_token");try{let c=await fetch(`${D}/api/sweets/${a}/`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}});if(403===c.status)return void F("Access Denied: Admin only","error");c.ok?(F("Sweet deleted successfully!","success"),G()):F("Failed to delete sweet","error")}catch(a){F("Failed to delete sweet","error")}},O=async a=>{if(a.preventDefault(),!z)return;let b=localStorage.getItem("access_token");try{let a=await fetch(`${D}/api/sweets/${z.id}/restock/`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({quantity:Number.parseInt(B.sweetQuantity)})});if(403===a.status)return void F("Access Denied: Admin only","error");a.ok?(F("Sweet restocked successfully!","success"),y(null),A(null),C({...B,sweetQuantity:""}),G()):F("Failed to restock sweet","error")}catch(a){F("Failed to restock sweet","error")}},P=[...new Set(j.map(a=>a.category))];return(0,b.jsxs)("div",{className:"app-container",children:[(0,b.jsx)("nav",{className:"navbar",children:(0,b.jsxs)("div",{className:"nav-content",children:[(0,b.jsx)("h1",{className:"logo",children:"ðŸ¬ Sweet Shop"}),(0,b.jsx)("div",{className:"nav-links",children:a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("span",{className:"user-info",children:["Welcome, ",h?.username]}),h?.is_staff&&(0,b.jsx)("span",{className:"admin-badge",children:"Admin"}),(0,b.jsx)("button",{onClick:J,className:"btn-secondary",children:"Logout"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>g("login"),className:"btn-link",children:"Login"}),(0,b.jsx)("button",{onClick:()=>g("register"),className:"btn-primary",children:"Register"})]})})]})}),v.text&&(0,b.jsx)("div",{className:`message-banner ${v.type}`,children:v.text}),(0,b.jsxs)("main",{className:"main-content",children:["login"===f&&!a&&(0,b.jsx)("div",{className:"auth-container",children:(0,b.jsxs)("div",{className:"auth-card",children:[(0,b.jsx)("h2",{children:"Login to Sweet Shop"}),(0,b.jsxs)("form",{onSubmit:H,children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Username"}),(0,b.jsx)("input",{type:"text",value:B.username,onChange:a=>C({...B,username:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Password"}),(0,b.jsx)("input",{type:"password",value:B.password,onChange:a=>C({...B,password:a.target.value}),required:!0})]}),(0,b.jsx)("button",{type:"submit",className:"btn-primary btn-full",children:"Login"})]}),(0,b.jsxs)("p",{className:"auth-switch",children:["Don't have an account?"," ",(0,b.jsx)("button",{onClick:()=>g("register"),className:"btn-link",children:"Register here"})]})]})}),"register"===f&&!a&&(0,b.jsx)("div",{className:"auth-container",children:(0,b.jsxs)("div",{className:"auth-card",children:[(0,b.jsx)("h2",{children:"Create Account"}),(0,b.jsxs)("form",{onSubmit:I,children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Username"}),(0,b.jsx)("input",{type:"text",value:B.username,onChange:a=>C({...B,username:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Email"}),(0,b.jsx)("input",{type:"email",value:B.email,onChange:a=>C({...B,email:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Password"}),(0,b.jsx)("input",{type:"password",value:B.password,onChange:a=>C({...B,password:a.target.value}),required:!0})]}),(0,b.jsx)("button",{type:"submit",className:"btn-primary btn-full",children:"Register"})]}),(0,b.jsxs)("p",{className:"auth-switch",children:["Already have an account?"," ",(0,b.jsx)("button",{onClick:()=>g("login"),className:"btn-link",children:"Login here"})]})]})}),"dashboard"===f&&a&&(0,b.jsxs)("div",{className:"dashboard-container",children:[h?.is_staff&&(0,b.jsxs)("div",{className:"admin-panel",children:[(0,b.jsx)("h2",{children:"Admin Controls"}),(0,b.jsx)("div",{className:"admin-actions",children:(0,b.jsx)("button",{onClick:()=>y("add"),className:"btn-admin",children:"+ Add Sweet"})}),"add"===x&&(0,b.jsxs)("div",{className:"admin-form",children:[(0,b.jsx)("h3",{children:"Add New Sweet"}),(0,b.jsxs)("form",{onSubmit:L,children:[(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Name"}),(0,b.jsx)("input",{type:"text",value:B.sweetName,onChange:a=>C({...B,sweetName:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Category"}),(0,b.jsx)("input",{type:"text",value:B.sweetCategory,onChange:a=>C({...B,sweetCategory:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Price ($)"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:B.sweetPrice,onChange:a=>C({...B,sweetPrice:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Quantity"}),(0,b.jsx)("input",{type:"number",value:B.sweetQuantity,onChange:a=>C({...B,sweetQuantity:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"submit",className:"btn-primary",children:"Add Sweet"}),(0,b.jsx)("button",{type:"button",onClick:()=>y(null),className:"btn-secondary",children:"Cancel"})]})]})]}),"update"===x&&z&&(0,b.jsxs)("div",{className:"admin-form",children:[(0,b.jsx)("h3",{children:"Update Sweet"}),(0,b.jsxs)("form",{onSubmit:M,children:[(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Name"}),(0,b.jsx)("input",{type:"text",value:B.sweetName,onChange:a=>C({...B,sweetName:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Category"}),(0,b.jsx)("input",{type:"text",value:B.sweetCategory,onChange:a=>C({...B,sweetCategory:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Price ($)"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:B.sweetPrice,onChange:a=>C({...B,sweetPrice:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Quantity"}),(0,b.jsx)("input",{type:"number",value:B.sweetQuantity,onChange:a=>C({...B,sweetQuantity:a.target.value}),required:!0})]})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"submit",className:"btn-primary",children:"Update Sweet"}),(0,b.jsx)("button",{type:"button",onClick:()=>{y(null),A(null)},className:"btn-secondary",children:"Cancel"})]})]})]}),"restock"===x&&z&&(0,b.jsxs)("div",{className:"admin-form",children:[(0,b.jsxs)("h3",{children:["Restock: ",z.name]}),(0,b.jsxs)("form",{onSubmit:O,children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Add Quantity"}),(0,b.jsx)("input",{type:"number",value:B.sweetQuantity,onChange:a=>C({...B,sweetQuantity:a.target.value}),required:!0,min:"1"})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"submit",className:"btn-primary",children:"Restock"}),(0,b.jsx)("button",{type:"button",onClick:()=>{y(null),A(null)},className:"btn-secondary",children:"Cancel"})]})]})]})]}),(0,b.jsxs)("div",{className:"filter-section",children:[(0,b.jsx)("h2",{children:"Browse Our Sweets"}),(0,b.jsxs)("div",{className:"filters",children:[(0,b.jsx)("div",{className:"filter-group",children:(0,b.jsx)("input",{type:"text",placeholder:"Search by name or category...",value:n,onChange:a=>o(a.target.value),className:"search-input"})}),(0,b.jsxs)("div",{className:"filter-row",children:[(0,b.jsxs)("select",{value:p,onChange:a=>q(a.target.value),className:"filter-select",children:[(0,b.jsx)("option",{value:"",children:"All Categories"}),P.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsx)("input",{type:"number",placeholder:"Min Price",value:r,onChange:a=>s(a.target.value),className:"filter-input"}),(0,b.jsx)("input",{type:"number",placeholder:"Max Price",value:t,onChange:a=>u(a.target.value),className:"filter-input"}),(n||p||r||t)&&(0,b.jsx)("button",{onClick:()=>{o(""),q(""),s(""),u("")},className:"btn-clear",children:"Clear Filters"})]})]})]}),(0,b.jsx)("div",{className:"sweets-grid",children:0===l.length?(0,b.jsx)("div",{className:"empty-state",children:(0,b.jsx)("p",{children:"No sweets found. Try adjusting your filters!"})}):l.map(a=>(0,b.jsxs)("div",{className:"sweet-card",children:[(0,b.jsxs)("div",{className:"sweet-header",children:[(0,b.jsx)("h3",{children:a.name}),(0,b.jsx)("span",{className:"category-badge",children:a.category})]}),(0,b.jsxs)("div",{className:"sweet-details",children:[(0,b.jsxs)("div",{className:"price",children:["$",a.price.toFixed(2)]}),(0,b.jsx)("div",{className:`quantity ${0===a.quantity?"out-of-stock":""}`,children:a.quantity>0?`${a.quantity} in stock`:"Out of stock"})]}),(0,b.jsxs)("div",{className:"sweet-actions",children:[(0,b.jsx)("button",{onClick:()=>K(a.id),disabled:0===a.quantity,className:"btn-purchase",children:0===a.quantity?"Out of Stock":"Purchase"}),h?.is_staff&&(0,b.jsxs)("div",{className:"admin-buttons",children:[(0,b.jsx)("button",{onClick:()=>{A(a),C({...B,sweetName:a.name,sweetCategory:a.category,sweetPrice:a.price.toString(),sweetQuantity:a.quantity.toString()}),y("update")},className:"btn-icon",title:"Edit",children:"âœï¸"}),(0,b.jsx)("button",{onClick:()=>{A(a),C({...B,sweetQuantity:""}),y("restock")},className:"btn-icon",title:"Restock",children:"ðŸ“¦"}),(0,b.jsx)("button",{onClick:()=>N(a.id),className:"btn-icon btn-delete",title:"Delete",children:"ðŸ—‘ï¸"})]})]})]},a.id))})]})]})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map