(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var s=e.i(47167),t=e.i(43476),a=e.i(71645),r=e.i(18566);function i(){let[e,i]=(0,a.useState)(!1),[n,l]=(0,a.useState)("login"),[c,o]=(0,a.useState)(null),[d,u]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[p,g]=(0,a.useState)(""),[y,x]=(0,a.useState)(""),[j,w]=(0,a.useState)(""),[f,v]=(0,a.useState)(""),[N,b]=(0,a.useState)({text:"",type:""}),[C,S]=(0,a.useState)(null),[k,P]=(0,a.useState)(null);(0,r.useRouter)();let[A,q]=(0,a.useState)({username:"",email:"",password:"",sweetName:"",sweetCategory:"",sweetPrice:"",sweetQuantity:""}),$=s.default.env.NEXT_PUBLIC_API_URL||"http://localhost:8000";(0,a.useEffect)(()=>{let e=localStorage.getItem("access_token"),s=localStorage.getItem("user");e&&s&&(i(!0),o(JSON.parse(s)),l("dashboard"),Q())},[]),(0,a.useEffect)(()=>{T()},[p,y,j,f,d]);let T=()=>{let e=[...d];p&&(e=e.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.category.toLowerCase().includes(p.toLowerCase()))),y&&(e=e.filter(e=>e.category.toLowerCase()===y.toLowerCase())),j&&(e=e.filter(e=>e.price>=Number.parseFloat(j))),f&&(e=e.filter(e=>e.price<=Number.parseFloat(f))),h(e)},L=(e,s)=>{b({text:e,type:s}),setTimeout(()=>b({text:"",type:""}),4e3)},Q=async()=>{let e=localStorage.getItem("access_token");try{let s=await fetch(`${$}/api/sweets/`,{headers:{Authorization:`Bearer ${e}`}});if(401===s.status)return void I();if(s.ok){let e=await s.json();u(e)}}catch(e){L("Failed to fetch sweets","error")}},_=async e=>{e.preventDefault();try{let e=await fetch(`${$}/api/auth/login/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:A.username,password:A.password})}),s=await e.json();if(e.ok){localStorage.setItem("access_token",s.access_token);let e={username:A.username,is_staff:s.is_staff||!1};localStorage.setItem("user",JSON.stringify(e)),o(e),i(!0),l("dashboard"),L("Login successful!","success"),Q()}else L(s.message||"Login failed","error")}catch(e){L("Login failed. Please try again.","error")}},F=async e=>{e.preventDefault();try{let e=await fetch(`${$}/api/auth/register/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:A.username,email:A.email,password:A.password})}),s=await e.json();e.ok?(L("Registration successful! Please login.","success"),l("login"),q({...A,password:""})):L(s.message||"Registration failed","error")}catch(e){L("Registration failed. Please try again.","error")}},I=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("user"),i(!1),o(null),l("login"),u([]),L("Logged out successfully","success")},O=async e=>{let s=localStorage.getItem("access_token");try{let t=await fetch(`${$}/api/sweets/${e}/purchase/`,{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(401===t.status)return void I();if(t.ok)L("Purchase successful!","success"),Q();else{let e=await t.json();L(e.message||"Purchase failed","error")}}catch(e){L("Purchase failed. Please try again.","error")}},R=async e=>{e.preventDefault();let s=localStorage.getItem("access_token");try{let e=await fetch(`${$}/api/sweets/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({name:A.sweetName,category:A.sweetCategory,price:Number.parseFloat(A.sweetPrice),quantity:Number.parseInt(A.sweetQuantity)})});if(403===e.status)return void L("Access Denied: Admin only","error");e.ok?(L("Sweet added successfully!","success"),S(null),q({...A,sweetName:"",sweetCategory:"",sweetPrice:"",sweetQuantity:""}),Q()):L("Failed to add sweet","error")}catch(e){L("Failed to add sweet","error")}},D=async e=>{if(e.preventDefault(),!k)return;let s=localStorage.getItem("access_token");try{let e=await fetch(`${$}/api/sweets/${k.id}/`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({name:A.sweetName,category:A.sweetCategory,price:Number.parseFloat(A.sweetPrice),quantity:Number.parseInt(A.sweetQuantity)})});if(403===e.status)return void L("Access Denied: Admin only","error");e.ok?(L("Sweet updated successfully!","success"),S(null),P(null),q({...A,sweetName:"",sweetCategory:"",sweetPrice:"",sweetQuantity:""}),Q()):L("Failed to update sweet","error")}catch(e){L("Failed to update sweet","error")}},B=async e=>{if(!confirm("Are you sure you want to delete this sweet?"))return;let s=localStorage.getItem("access_token");try{let t=await fetch(`${$}/api/sweets/${e}/`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(403===t.status)return void L("Access Denied: Admin only","error");t.ok?(L("Sweet deleted successfully!","success"),Q()):L("Failed to delete sweet","error")}catch(e){L("Failed to delete sweet","error")}},U=async e=>{if(e.preventDefault(),!k)return;let s=localStorage.getItem("access_token");try{let e=await fetch(`${$}/api/sweets/${k.id}/restock/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({quantity:Number.parseInt(A.sweetQuantity)})});if(403===e.status)return void L("Access Denied: Admin only","error");e.ok?(L("Sweet restocked successfully!","success"),S(null),P(null),q({...A,sweetQuantity:""}),Q()):L("Failed to restock sweet","error")}catch(e){L("Failed to restock sweet","error")}},E=[...new Set(d.map(e=>e.category))];return(0,t.jsxs)("div",{className:"app-container",children:[(0,t.jsx)("nav",{className:"navbar",children:(0,t.jsxs)("div",{className:"nav-content",children:[(0,t.jsx)("h1",{className:"logo",children:"ðŸ¬ Sweet Shop"}),(0,t.jsx)("div",{className:"nav-links",children:e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"user-info",children:["Welcome, ",c?.username]}),c?.is_staff&&(0,t.jsx)("span",{className:"admin-badge",children:"Admin"}),(0,t.jsx)("button",{onClick:I,className:"btn-secondary",children:"Logout"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>l("login"),className:"btn-link",children:"Login"}),(0,t.jsx)("button",{onClick:()=>l("register"),className:"btn-primary",children:"Register"})]})})]})}),N.text&&(0,t.jsx)("div",{className:`message-banner ${N.type}`,children:N.text}),(0,t.jsxs)("main",{className:"main-content",children:["login"===n&&!e&&(0,t.jsx)("div",{className:"auth-container",children:(0,t.jsxs)("div",{className:"auth-card",children:[(0,t.jsx)("h2",{children:"Login to Sweet Shop"}),(0,t.jsxs)("form",{onSubmit:_,children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Username"}),(0,t.jsx)("input",{type:"text",value:A.username,onChange:e=>q({...A,username:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Password"}),(0,t.jsx)("input",{type:"password",value:A.password,onChange:e=>q({...A,password:e.target.value}),required:!0})]}),(0,t.jsx)("button",{type:"submit",className:"btn-primary btn-full",children:"Login"})]}),(0,t.jsxs)("p",{className:"auth-switch",children:["Don't have an account?"," ",(0,t.jsx)("button",{onClick:()=>l("register"),className:"btn-link",children:"Register here"})]})]})}),"register"===n&&!e&&(0,t.jsx)("div",{className:"auth-container",children:(0,t.jsxs)("div",{className:"auth-card",children:[(0,t.jsx)("h2",{children:"Create Account"}),(0,t.jsxs)("form",{onSubmit:F,children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Username"}),(0,t.jsx)("input",{type:"text",value:A.username,onChange:e=>q({...A,username:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Email"}),(0,t.jsx)("input",{type:"email",value:A.email,onChange:e=>q({...A,email:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Password"}),(0,t.jsx)("input",{type:"password",value:A.password,onChange:e=>q({...A,password:e.target.value}),required:!0})]}),(0,t.jsx)("button",{type:"submit",className:"btn-primary btn-full",children:"Register"})]}),(0,t.jsxs)("p",{className:"auth-switch",children:["Already have an account?"," ",(0,t.jsx)("button",{onClick:()=>l("login"),className:"btn-link",children:"Login here"})]})]})}),"dashboard"===n&&e&&(0,t.jsxs)("div",{className:"dashboard-container",children:[c?.is_staff&&(0,t.jsxs)("div",{className:"admin-panel",children:[(0,t.jsx)("h2",{children:"Admin Controls"}),(0,t.jsx)("div",{className:"admin-actions",children:(0,t.jsx)("button",{onClick:()=>S("add"),className:"btn-admin",children:"+ Add Sweet"})}),"add"===C&&(0,t.jsxs)("div",{className:"admin-form",children:[(0,t.jsx)("h3",{children:"Add New Sweet"}),(0,t.jsxs)("form",{onSubmit:R,children:[(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Name"}),(0,t.jsx)("input",{type:"text",value:A.sweetName,onChange:e=>q({...A,sweetName:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Category"}),(0,t.jsx)("input",{type:"text",value:A.sweetCategory,onChange:e=>q({...A,sweetCategory:e.target.value}),required:!0})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Price ($)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:A.sweetPrice,onChange:e=>q({...A,sweetPrice:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Quantity"}),(0,t.jsx)("input",{type:"number",value:A.sweetQuantity,onChange:e=>q({...A,sweetQuantity:e.target.value}),required:!0})]})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"submit",className:"btn-primary",children:"Add Sweet"}),(0,t.jsx)("button",{type:"button",onClick:()=>S(null),className:"btn-secondary",children:"Cancel"})]})]})]}),"update"===C&&k&&(0,t.jsxs)("div",{className:"admin-form",children:[(0,t.jsx)("h3",{children:"Update Sweet"}),(0,t.jsxs)("form",{onSubmit:D,children:[(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Name"}),(0,t.jsx)("input",{type:"text",value:A.sweetName,onChange:e=>q({...A,sweetName:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Category"}),(0,t.jsx)("input",{type:"text",value:A.sweetCategory,onChange:e=>q({...A,sweetCategory:e.target.value}),required:!0})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Price ($)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:A.sweetPrice,onChange:e=>q({...A,sweetPrice:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Quantity"}),(0,t.jsx)("input",{type:"number",value:A.sweetQuantity,onChange:e=>q({...A,sweetQuantity:e.target.value}),required:!0})]})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"submit",className:"btn-primary",children:"Update Sweet"}),(0,t.jsx)("button",{type:"button",onClick:()=>{S(null),P(null)},className:"btn-secondary",children:"Cancel"})]})]})]}),"restock"===C&&k&&(0,t.jsxs)("div",{className:"admin-form",children:[(0,t.jsxs)("h3",{children:["Restock: ",k.name]}),(0,t.jsxs)("form",{onSubmit:U,children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Add Quantity"}),(0,t.jsx)("input",{type:"number",value:A.sweetQuantity,onChange:e=>q({...A,sweetQuantity:e.target.value}),required:!0,min:"1"})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"submit",className:"btn-primary",children:"Restock"}),(0,t.jsx)("button",{type:"button",onClick:()=>{S(null),P(null)},className:"btn-secondary",children:"Cancel"})]})]})]})]}),(0,t.jsxs)("div",{className:"filter-section",children:[(0,t.jsx)("h2",{children:"Browse Our Sweets"}),(0,t.jsxs)("div",{className:"filters",children:[(0,t.jsx)("div",{className:"filter-group",children:(0,t.jsx)("input",{type:"text",placeholder:"Search by name or category...",value:p,onChange:e=>g(e.target.value),className:"search-input"})}),(0,t.jsxs)("div",{className:"filter-row",children:[(0,t.jsxs)("select",{value:y,onChange:e=>x(e.target.value),className:"filter-select",children:[(0,t.jsx)("option",{value:"",children:"All Categories"}),E.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsx)("input",{type:"number",placeholder:"Min Price",value:j,onChange:e=>w(e.target.value),className:"filter-input"}),(0,t.jsx)("input",{type:"number",placeholder:"Max Price",value:f,onChange:e=>v(e.target.value),className:"filter-input"}),(p||y||j||f)&&(0,t.jsx)("button",{onClick:()=>{g(""),x(""),w(""),v("")},className:"btn-clear",children:"Clear Filters"})]})]})]}),(0,t.jsx)("div",{className:"sweets-grid",children:0===m.length?(0,t.jsx)("div",{className:"empty-state",children:(0,t.jsx)("p",{children:"No sweets found. Try adjusting your filters!"})}):m.map(e=>(0,t.jsxs)("div",{className:"sweet-card",children:[(0,t.jsxs)("div",{className:"sweet-header",children:[(0,t.jsx)("h3",{children:e.name}),(0,t.jsx)("span",{className:"category-badge",children:e.category})]}),(0,t.jsxs)("div",{className:"sweet-details",children:[(0,t.jsxs)("div",{className:"price",children:["$",e.price.toFixed(2)]}),(0,t.jsx)("div",{className:`quantity ${0===e.quantity?"out-of-stock":""}`,children:e.quantity>0?`${e.quantity} in stock`:"Out of stock"})]}),(0,t.jsxs)("div",{className:"sweet-actions",children:[(0,t.jsx)("button",{onClick:()=>O(e.id),disabled:0===e.quantity,className:"btn-purchase",children:0===e.quantity?"Out of Stock":"Purchase"}),c?.is_staff&&(0,t.jsxs)("div",{className:"admin-buttons",children:[(0,t.jsx)("button",{onClick:()=>{P(e),q({...A,sweetName:e.name,sweetCategory:e.category,sweetPrice:e.price.toString(),sweetQuantity:e.quantity.toString()}),S("update")},className:"btn-icon",title:"Edit",children:"âœï¸"}),(0,t.jsx)("button",{onClick:()=>{P(e),q({...A,sweetQuantity:""}),S("restock")},className:"btn-icon",title:"Restock",children:"ðŸ“¦"}),(0,t.jsx)("button",{onClick:()=>B(e.id),className:"btn-icon btn-delete",title:"Delete",children:"ðŸ—‘ï¸"})]})]})]},e.id))})]})]})]})}e.s(["default",()=>i])}]);